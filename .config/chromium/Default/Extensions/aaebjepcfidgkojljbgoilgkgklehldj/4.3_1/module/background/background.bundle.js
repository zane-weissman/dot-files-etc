(function(){
var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(b,g,f){if(f.get||f.set)throw new TypeError("ES3 does not support getters and setters.");b!=Array.prototype&&b!=Object.prototype&&(b[g]=f.value)};$jscomp.getGlobal=function(b){return"undefined"!=typeof window&&window===b?b:"undefined"!=typeof global&&null!=global?global:b};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var b=$jscomp.global.Symbol.iterator;b||(b=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[b]&&$jscomp.defineProperty(Array.prototype,b,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(b){var g=0;return $jscomp.iteratorPrototype(function(){return g<b.length?{done:!1,value:b[g++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(b){$jscomp.initSymbolIterator();b={next:b};b[$jscomp.global.Symbol.iterator]=function(){return this};return b};$jscomp.makeIterator=function(b){$jscomp.initSymbolIterator();var g=b[Symbol.iterator];return g?g.call(b):$jscomp.arrayIterator(b)};$jscomp.owns=function(b,g){return Object.prototype.hasOwnProperty.call(b,g)};
$jscomp.polyfill=function(b,g,f,h){if(g){f=$jscomp.global;b=b.split(".");for(h=0;h<b.length-1;h++){var l=b[h];l in f||(f[l]={});f=f[l]}b=b[b.length-1];h=f[b];g=g(h);g!=h&&null!=g&&$jscomp.defineProperty(f,b,{configurable:!0,writable:!0,value:g})}};
$jscomp.polyfill("WeakMap",function(b){function g(c){$jscomp.owns(c,h)||$jscomp.defineProperty(c,h,{value:{}})}function f(c){var a=Object[c];a&&(Object[c]=function(d){g(d);return a(d)})}if(function(){if(!b||!Object.seal)return!1;try{var c=Object.seal({}),a=Object.seal({}),d=new b([[c,2],[a,3]]);if(2!=d.get(c)||3!=d.get(a))return!1;d["delete"](c);d.set(a,4);return!d.has(c)&&4==d.get(a)}catch(q){return!1}}())return b;var h="$jscomp_hidden_"+Math.random().toString().substring(2);f("freeze");f("preventExtensions");
f("seal");var l=0,e=function(c){this.id_=(l+=Math.random()+1).toString();if(c){$jscomp.initSymbol();$jscomp.initSymbolIterator();c=$jscomp.makeIterator(c);for(var a;!(a=c.next()).done;)a=a.value,this.set(a[0],a[1])}};e.prototype.set=function(c,a){g(c);if(!$jscomp.owns(c,h))throw Error("WeakMap key fail: "+c);c[h][this.id_]=a;return this};e.prototype.get=function(c){return $jscomp.owns(c,h)?c[h][this.id_]:void 0};e.prototype.has=function(c){return $jscomp.owns(c,h)&&$jscomp.owns(c[h],this.id_)};e.prototype["delete"]=
function(c){return $jscomp.owns(c,h)&&$jscomp.owns(c[h],this.id_)?delete c[h][this.id_]:!1};return e},"es6-impl","es3");$jscomp.ASSUME_NO_NATIVE_MAP=!1;
$jscomp.polyfill("Map",function(b){if(!$jscomp.ASSUME_NO_NATIVE_MAP&&function(){if(!b||!b.prototype.entries||"function"!=typeof Object.seal)return!1;try{var a=Object.seal({x:4}),d=new b($jscomp.makeIterator([[a,"s"]]));if("s"!=d.get(a)||1!=d.size||d.get({x:4})||d.set({x:4},"t")!=d||2!=d.size)return!1;var c=d.entries(),k=c.next();if(k.done||k.value[0]!=a||"s"!=k.value[1])return!1;k=c.next();return k.done||4!=k.value[0].x||"t"!=k.value[1]||!c.next().done?!1:!0}catch(n){return!1}}())return b;$jscomp.initSymbol();
$jscomp.initSymbolIterator();var g=new WeakMap,f=function(a){this.data_={};this.head_=e();this.size=0;if(a){a=$jscomp.makeIterator(a);for(var d;!(d=a.next()).done;)d=d.value,this.set(d[0],d[1])}};f.prototype.set=function(a,d){var c=h(this,a);c.list||(c.list=this.data_[c.id]=[]);c.entry?c.entry.value=d:(c.entry={next:this.head_,previous:this.head_.previous,head:this.head_,key:a,value:d},c.list.push(c.entry),this.head_.previous.next=c.entry,this.head_.previous=c.entry,this.size++);return this};f.prototype["delete"]=
function(a){a=h(this,a);return a.entry&&a.list?(a.list.splice(a.index,1),a.list.length||delete this.data_[a.id],a.entry.previous.next=a.entry.next,a.entry.next.previous=a.entry.previous,a.entry.head=null,this.size--,!0):!1};f.prototype.clear=function(){this.data_={};this.head_=this.head_.previous=e();this.size=0};f.prototype.has=function(a){return!!h(this,a).entry};f.prototype.get=function(a){return(a=h(this,a).entry)&&a.value};f.prototype.entries=function(){return l(this,function(a){return[a.key,
a.value]})};f.prototype.keys=function(){return l(this,function(a){return a.key})};f.prototype.values=function(){return l(this,function(a){return a.value})};f.prototype.forEach=function(a,c){for(var d=this.entries(),b;!(b=d.next()).done;)b=b.value,a.call(c,b[1],b[0],this)};f.prototype[Symbol.iterator]=f.prototype.entries;var h=function(a,d){var b;b=d&&typeof d;"object"==b||"function"==b?g.has(d)?b=g.get(d):(b=""+ ++c,g.set(d,b)):b="p_"+d;var f=a.data_[b];if(f&&$jscomp.owns(a.data_,b))for(var e=0;e<
f.length;e++){var h=f[e];if(d!==d&&h.key!==h.key||d===h.key)return{id:b,list:f,index:e,entry:h}}return{id:b,list:f,index:-1,entry:void 0}},l=function(a,c){var d=a.head_;return $jscomp.iteratorPrototype(function(){if(d){for(;d.head!=a.head_;)d=d.previous;for(;d.next!=d.head;)return d=d.next,{done:!1,value:c(d)};d=null}return{done:!0,value:void 0}})},e=function(){var a={};return a.previous=a.next=a.head=a},c=0;return f},"es6-impl","es3");
$jscomp.polyfill("Object.assign",function(b){return b?b:function(b,f){for(var h=1;h<arguments.length;h++){var g=arguments[h];if(g)for(var e in g)$jscomp.owns(g,e)&&(b[e]=g[e])}return b}},"es6-impl","es3");
webpackJsonp([1],[function(b,g,f){(function(b){var h=f(3),e=f(4),c=f(5)("AwesomeDrive","EventListener"),a={};window.altirnao=window.altirnao||{};altirnao.ports=a;var d=f(9)(a),g=[new chrome.declarativeContent.PageStateMatcher({pageUrl:{hostEquals:h.drive},css:[f(15).mainPage]})],k=function(a,f){a.onMessage.addListener(function(e){var u="on"+(f?"External":"")+"Message";try{c.info(u,"Received action: ",e.action),b.isFunction(d[e.action])?d[e.action](a,e.action,f?e:e.data):c.error(u,"Cannot execute unknown action:",
e.action)}catch(t){c.error(u,"An error occurred while processing message in the background",e,a,t)}})},n=function(d){d.onDisconnect.addListener(function(){c.info("onDisconnect()","A background connection was closed for user",d.name);var f=d.name;a[f]=b.grep(a[f],function(a){return a!=d})})},p=function(){chrome.declarativeContent.onPageChanged.removeRules(void 0,function(){chrome.declarativeContent.onPageChanged.addRules([{conditions:g,actions:[new chrome.declarativeContent.ShowPageAction]}],function(a){c.info("_registerShowPageActionRules()",
"AwesomeDrive show page-action icon rules registered",a)})})};(function(){chrome.runtime.onInstalled.addListener(function(a){c.info("onInstalled()","AwesomeDrive installed or updated, registering show page-action rules");p()})})();(function(){chrome.declarativeContent.onPageChanged.getRules(void 0,function(a){void 0!=a&&0!=a.length&&a[0]&&a[0].conditions&&a[0].conditions.length==g.length&&!e.objectEquals(g,a[0].conditions,!1)||(c.info("onPageChanged()","AwesomeDrive has no registered rules or rules changed. Registering show page-action rules"),
p())})})();(function(){chrome.runtime.onConnect.addListener(function(d){try{var b=d.name;(a[b]=a[b]||[]).push(d);c.info("onConnect()","New background connection established for user",b);k(d,!1);n(d)}catch(r){c.error("onConnect()","An error occurred while establishing connection to the background",d,r)}});chrome.runtime.onConnectExternal.addListener(function(a){try{c.info("onConnectExternal()","New external connection established from",a.sender),k(a,!0)}catch(z){c.error("onConnectExternal()","Unexpected background error on a content port",
a?{name:a.name,sender:a.sender}:"",z)}})})();(function(){chrome.runtime.onMessage.addListener(function(a,f,e){"page-action"==a.from&&(b.isFunction(d[a.action])?d[a.action](e,a.action,a.data):c.error("onPageActionMessage()","Cannot execute unknown action:",a.action))})})();d.sendGAnalyticsData(null,null,{hitType:"page",hitData:{page:"/background"}})}).call(g,f(2))},,,,,,,,,function(b,g,f){(function(g){function h(b){function f(a,b,c){if("function"===typeof a)a(c);else try{a.postMessage({action:b,response:c,
from:"background"})}catch(v){v.message.match("disconnected port")?d.console(console.warn,["_postResponse()","Skip post reponse as the content port is disconnected",v]):d.error("_postResponse()","Failed to post response from background for action "+b,v)}}function n(a,b,c,e,g){g=void 0===g?1:g;m.refreshAccessToken(a.refreshToken,e,function(g,h,k){a.accessTokenDate=(new Date).valueOf();a.accessToken=g;a.expiresIn=h;a.refreshToken=k;m.setSource(a,e);f(b,c);d.info("_refreshAccessToken()","Successfully refresh expired OAuth token")},
function(){d.info("_refreshAccessToken()","OAuth token has been revoked, remove it from cache");x(a,b,c,e)},function(d,f){r(d,f,a,b,c,e,"refresh OAuth token",n,g)})}function l(a,b,c,e,g){g=void 0===g?1:g;var h=function(d,f){r(d,f,a,b,c,e,"check OAuth token validity",l,g)};fetch("https://www.googleapis.com/oauth2/v1/tokeninfo?access_token="+a.accessToken).then(function(a){return a.json().then(function(e){a.ok?(d.info("_checkTokenValidity()","Cached OAuth token is still valid"),f(b,c)):h(a.status,e)})})["catch"](h)}
function r(b,c,e,g,h,k,n,l,p){500<=b?4>=p?(c=a.getExponentialBackoffDelay(p),d.info("_onTokenCheckError()","Failed to "+n+" due to server "+("error ("+b+"), will retry in "+(c/1E3).toFixed(2)+"s")),setTimeout(function(){d.info("_onTokenCheckError()","Retry "+("("+p+") "+n+" as previous attempt failed"));l(e,g,h,k,++p)},c)):(d.error("_onTokenCheckError()","Failed to "+n+" "+("after "+p+" attempts, remove it from cache"),{status:b,response:c}),f(g,h)):(d.info("_onTokenCheckError()","Cached OAuth token is not valid anymore, remove it from cache",
{status:b,response:c}),x(e,g,h,k))}function x(a,b,c,d){m.clearTokenData(d);a.accessToken=null;f(b,c)}function t(a){d.info("_refreshLocksToken()","Refresh webdav backend locks token for user",a);m.authorize(a,function(){g.ajax({type:"POST",url:q.apiUrls.driveUtils+"/user/authentication",success:function(){d.info("_refreshLocksToken()","Token refreshed for user",a);y(a)},error:function(b){401===b.status?(clearTimeout(w[a]),d.warn("_refreshLocksToken()","AwesomeDrive token has been revoked, stop scheduled backend token refresh for user",
a)):(0!==b.status?d.error("_refreshLocksToken()","Failed to refresh token for user",a,{status:b.status,statusText:b.statusText,responseText:b.responseText}):d.console(console.error,["_refreshLocksToken()","Internet connection lost, preflight request failed or interrupted request"]),y(a,b.status))},beforeSend:function(b){return b.setRequestHeader("Authorization","Bearer "+m.getAccessToken(a))}})})}function y(a,b){clearTimeout(w[a]);w[a]=setTimeout(function(){return t(a)},function(){if(void 0!==b&&
0===b)return 1E4;var c=m.get(null,a);return Math.max(c.accessTokenDate+1E3*c.expiresIn-Date.now()-6E5,5E3)}())}if(!(this instanceof h))return new h(b);var m=new OAuth2("google",{client_id:e.clientId,client_secret:e.clientSecret,api_scope:e.apiScopes.join(" ")}),w={};this.getOAuth2Token=function(a,b,c){var e=m.get(null,c.email),g=function(){m.authorize(c.email,function(d){f(a,b,{token:m.getAccessToken(c.email),tokenAlreadyExists:d})})},h=function(){e&&e.accessToken&&c.checkValidity?(d.info("getOAuth2Token()",
"Checking OAuth token validity..."),l(e,g,b,c.email)):g()};e&&e.accessToken&&m.isAccessTokenExpired(c.email)?(d.info("getOAuth2Token()","Refreshing expired OAuth token..."),n(e,h,b,c.email)):h()};this.getOAuth2Info=function(a,b,c){m.authorize(c.email,function(){f(a,b,{oauth2Info:m.get(null,c.email)})})};this.getOS=function(a,b){chrome.runtime.getPlatformInfo(function(c){return f(a,b,c.os)})};this.showNotification=function(a,b,d){chrome.notifications.create(d.id,{type:d.type,title:chrome.i18n.getMessage(d.titleKey),
message:chrome.i18n.getMessage(d.contentKey),iconUrl:c.notification},g.noop)};this.setPageActionIcon=function(a,b,c){a.sender&&a.sender.tab&&chrome.pageAction.setIcon({tabId:a.sender.tab.id,path:c.path})};this.openTab=function(a,b,c){chrome.tabs.create({url:c.url},function(c){return f(a,b,c)})};this.sendTokenToDriveUtils=function(a,b,c){return t(c.email)};this.sendGAnalyticsData=function(a,b,c){try{var e=c.hitData;switch(c.hitType){case "page":k.pageview(e.page,e.extraData);break;case "event":k.event(e.category,
e.action,e.label,e.value,e.extraData)}}catch(A){d.error("sendGAnalyticsData()","Failed to send data to Google Analytics",A)}}}var e=f(10),c=f(12),a=f(4),d=f(5)("AwesomeDrive","MessageManager"),q=f(11),k=f(13)().getTracker({id:q.analyticsTrackerId,name:"awesomeDrive"});b.exports=h}).call(g,f(2))},function(b,g,f){g=f(11);b.exports={clientId:g.clientId,clientSecret:g.clientSecret,apiScopes:["https://www.googleapis.com/auth/userinfo.email","https://www.googleapis.com/auth/userinfo.profile","https://www.googleapis.com/auth/drive"]}},
,,function(b,g,f){function h(){if(q.shouldInit())if(d=!0,"ga"in window)this._debug("#_injectGaScript()",'analytics.js not inserted. "window.ga" already exists in the page'),l.call(this);else{this._debug("#_injectGaScript()","Asynchronously loading analytics.js script...");window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=Date.now();var a=document.createElement("script");a.src="https://www.google-analytics.com/analytics.js";a.async=!0;a.onload=l.bind(this);(document.head||document.documentElement).appendChild(a)}}
function l(){this._debug("#_onGaScriptLoaded()","Script analytics.js successfully loaded");if(this.onReady)this.onReady()}var e=function(){function a(a,c){for(var b=0;b<c.length;b++){var d=c[b];d.enumerable=d.enumerable||!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(a,d.key,d)}}return function(b,c,d){c&&a(b.prototype,c);d&&a(b,d);return b}}(),c=f(14),a=void 0,d=!1,q=function(){function a(b){if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");
this.onReady=b.onReady;this.debug=b.debug||!1;this.trackers=new Map;h.call(this)}e(a,null,[{key:"shouldInit",value:function(){return!d}}]);e(a,[{key:"getTracker",value:function(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},b=a.name?this.trackers.has(a.name):!1;if(!a.name||!b&&!a.id)return this._debug("#getTracker()",a,"Cannot get tracker: missing mandatory tracker id and/or tracker name"),null;b||(b=new c(a),this.trackers.set(a.name,b),this._debug("#getTracker()","New tracker",
a.name,"created",b));return this.trackers.get(a.name)}},{key:"_debug",value:function(){if(this.debug&&console&&console.debug){for(var a,b=arguments.length,c=Array(b),d=0;d<b;d++)c[d]=arguments[d];(a=console).debug.apply(a,["[Analytics] GaManager","-"].concat(c))}}}]);return a}();b.exports=function(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};a||(a=new q(b));return a}},function(b,g){var f=function(){function b(b,c){for(var a=0;a<c.length;a++){var d=c[a];d.enumerable=d.enumerable||
!1;d.configurable=!0;"value"in d&&(d.writable=!0);Object.defineProperty(b,d.key,d)}}return function(e,c,a){c&&b(e.prototype,c);a&&b(e,a);return e}}(),h=function(){function b(e){if(!(this instanceof b))throw new TypeError("Cannot call a class as a function");var c=[];e.name||c.push("name");e.id||c.push("id");if(c.length)throw Error("Missing required property "+c+" to instanciate the GaTracker");if(/[^a-z0-9]/gi.test(e.name))throw Error('The GaTracker "name" property should only consist of alphanumeric characters');
this.id=e.id;this.name=e.name;this.appName=e.appName;this.create()}f(b,[{key:"create",value:function(){var b={siteSpeedSampleRate:100};this.appName&&(b.appName=this.appName);ga("create",this.id,"auto",this.name,b);ga(this.name+".set","checkProtocolTask",null)}},{key:"screenview",value:function(b,c){if(!(this.appName||c&&c.appName))throw Error("data.appName is mandatory for every screenview hit as it has not been defined at tracker creation time");var a=Object.assign({screenName:b},c);ga(this.name+
".send","screenview",a)}},{key:"pageview",value:function(b,c){var a=Object.assign({page:b},c);ga(this.name+".send","pageview",a)}},{key:"event",value:function(b,c,a,d,f){var e={};a&&(e.eventLabel=a);"number"===typeof d&&(e.eventValue=d);e=Object.assign({eventCategory:b,eventAction:c,nonInteraction:!0},e,f);ga(this.name+".send","event",e)}},{key:"timing",value:function(b,c,a,d,f){var e={};d&&(e.timingLabel=d);e=Object.assign({timingCategory:b,timingVar:c,timingValue:a},e,f);ga(this.name+".send","timing",
e)}}]);return b}();b.exports=h}]);
}).call(this)

